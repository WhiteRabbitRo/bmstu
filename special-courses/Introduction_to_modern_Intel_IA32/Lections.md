## Лекция 2

### ???
* Intel VTune
* промах кэша
* антиотладка
* starforce
* rawhammer
* ecc
* трансзона
* PBKDF

### contents

1. регистры
2. память
3. что такое 16 битная память
4. вещественные числа

*x86(x86_64)*

##### регистры

1. общего назначения

        eax / ebx

    | name   | size  |
    |--------|-------|
    |    ax  | 16B   |
    |    eax | 32B   |
    |    rax | 64B   |

2. сегментные

        cs|ss|ds|fs|es
        code                                16
           stack            ------> | shadow |    |
              data                  63       15   0
                 .....

3. регистры флагов

        [r]
        [e]flags

4. регистры управления

        cr 0..4

5. отладочные регистры

        dr 0..8

6. MSR

        rmsr / wmsr

7. регистры [r]/[e]ip

*указывают на текущую исполняемую ф-ию в процессоре*

-----
### CASH as RAM

Memory

                 ____
                \/   |
        mov    [ ]  [ ]

                reg, memory/reg
                memory, reg

Memory - ячейка памяти

        mov eax, dword ptr ds:[ecx]
                            |   |
                        segment |
                              offset


segment * 16 + offset

------
### A21

    добавили дополнительный бит
    10FFEF                          +64kB
    in/out                          dx/eax/ax/d
------

|                        | Устройства | Слово  | Размер |
|------------------------|------------|--------|--------|
| mov ax, word ptr[cx]   | ввод/вывод | byte   | 1      |
| mov eax, dword ptr[ecx]| in/out     | word   | 2      |
| mov rax, qword ptr[rcx]| 0x3c       | dword  | 4      |
|                        | mov ax, 1  | qword  | 8      |
|                        | mov dx, 3ch|        |        |
|                        | out dx, ax |        |        |

------

Programmable Interaptio Controller

```
                                1
+-----+           +-----+    +-->
|     |           |     |    |    .....
| cpu +-----+---->+ pic +----+    Devices
|     |     ^     |     |    |    .....
+-----+     |     +-----+    +-->
            |
            |
            +
            interupt

```

## Лекция 3 (Прак 1)

### ???
* простой памяти
* pdb
* раскрутка стрека
* repmovsb
* rtdsc
* прокачка памяти

```

+---------------------------------+
|                                 |
|   cpu                           |
|                                 |
| +-----+ ADDR +----------------+ |
| |     +----->+                | |    +---------+
| |     | CTR  |                | |    |         |
| |     +----->+ mem controller +----->+ DDR 3/4 |
| |     | DATA |                | |    |         |
| |     +----->+                | |    +---------+
| +-----+      +----------------+ |
|                                 |
+---------------------------------+




                        +----+   +-----+
                             |   |     |
                    +------+ | +-+ MEM |
                    |      | | | |     |
                    | M.C. +<--+ +-----+
                    |      | |   +-----+    многоканальная память
                    +------+<--+ |     |
                             | | | MEM |
                       +-----+ +-+     |
                                 +-----+



```


```
 .c .cpp .h
    +
    |
    v
+-----+------+
|            |
| COMPILE    |
|            |
+-----+------+
      |
+-----v------+
|            |
| .obj       +--->  ASM
|            |
+-----+------+
      |
+-----v------+
|            |
| LINKING    |
|            |
+------------+


```

repmovsb

```
          +
          |         +------+
          |         |      v
          |         |
          |         |      +--------------------+
          |         v      |
DRAM      |                |
          |         +------+
          |         |
          |         |
          | +-------+
+---------------------------------------------------+
          |
CPU       | +-----------------------------------+
          |
+---------+-----------------------------------------+


```
Это хорошо

>выделен кусочек прогрева, после которого сразу выход на максимум производительности

```
          +
          |
          |                           +---------+
          |                           |
          |                    +------+
          |                    |
DRAM      |              +-----+
          |              |
          |         +----+
          |         |
          | +-------+
+---------------------------------------------------+
          |
CPU       | +-----------------------------------+
          |
+---------+-----------------------------------------+


```
Это плохо

> Здесь ступеньки из-за того что добавляется по чуть-чуть
